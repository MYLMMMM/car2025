# 智能车驱动板设计文档
## 设计指标
- 供电：$4.5V$-$37V$
- 驱动电流：$8A$（通过重新配置过流保护可增大）
- 最大驱动pwm频率：$263kHz$
## 器件选型
- 栅极驱动器： **DRV8705**
    - $4.9V-37V$工作电压
    - $0.5A-62A$峰值拉/灌电流
    - 集成低测电流放大器
- 全桥MOSFET：**AP90N04G**
    - $40V$  $80A$
    - $R_{DS}=5.5mΩ@1V_{GS}=10V$$

## 设计细节
### 栅极驱动器设计细节
#### VCP负载计算
根据DRVdatasheet p54 公式1
AP90N04G的$Q_g = 57nC@V_{gs}=10V$，设计驱动频率为$7KHz$；
$$
I_vcp = 57nC\times7kHz\times1 = 0.4 mA
$$
p15页给出平均输出能力为 $15mA$，目标设计满足电荷泵输出负载能力；
#### 计算驱动频率最大值
$$
f_{drv}=\frac{15mA}{57nC \times 1 } = 263kHz
$$
计算得最大驱动频率为263kHz
#### $I_{drive}$（栅极驱动电流）计算
AP90N04G的栅漏电荷$Q_{gd} = 11nC$，$t_{rise}=500ns$，$t_{fall}=300ns$
$$ I_{dp}=11nC/500ns=22mA $$$$ I_{dn}=11nC/300ns=36mA $$
p10给出了电平设置表，由表选择六电平电平5，进而由p9表确定连接方式：**IDRIVE**经过$62KΩ$电阻接**DVDD**
#### 电流放大器配置
阅读p28，H/W器件仅需配置GAIN引脚增益，并输入电压参考到**AREF**。
器件使用了1206采样电阻，功率额定值 $P_{SHUNT}=1W$。输入参考电压 $V_{AREF}=3.3V$。最大电流 $I_{MAX}= 5A$。
计算动态输出范围 $V_{SO}$，采样电流大小 $R_{SHUNT}$，放大器增益 $A_{V}$：
$$V_{SO}=(3.3V-0.25V)-(3.3V/2)=1.4V$$$$R_{SHUNT}<1W/5^2A=40mΩ$$$$A_V<1.4V/(5A\times40mΩ)=7V/V$$$$A_V<1.4V/(5A\times20mΩ)=14V/V$$
由计算：选择$20mΩ$$采样电阻，$10V/V$增益。由p12增益配置，选择四电平电平1.由p8，**GAIN**引脚直接接地
#### 过流保护配置
AP90N04G的$R_{DSMAX}=10mΩ$（5V下），在最小档$0.06V$时可通过电流$6A$而不触发过流保护。故选取最小挡，阅读p14得六电平电平1，**VDS**直接接地。
#### 驱动方式配置
驱动方式为**PH/EN**模式，阅读p23得四电平电平2，**MODE**引脚经过$47KΩ$电阻接地
